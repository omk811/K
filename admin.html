<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø±ÙˆØ³</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<style>
body{font-family:Cairo;background:#0a0a14;color:#fff}
.card{max-width:700px;margin:40px auto;background:rgba(139,92,246,.15);padding:20px;border-radius:20px}
input,button{width:100%;padding:12px;margin-bottom:10px;border-radius:12px;border:none}
button{background:#8b5cf6;color:#fff;font-weight:700;cursor:pointer}
.lesson{background:rgba(0,0,0,.3);padding:10px;border-radius:12px;margin-bottom:8px}
.on{background:#10b981}
.off{background:#ef4444}
.hidden{display:none}
</style>
</head>
<body>

<div id="login" class="card">
  <h2>ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù†</h2>
  <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
  <p id="msg"></p>
</div>

<div id="panel" class="card hidden">
  <h2>ğŸ“š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø±ÙˆØ³</h2>
  <input id="title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³">
  <input id="url" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø±Ø³">
  <button onclick="addLesson()">â• Ø¥Ø¶Ø§ÙØ©</button>
  <hr>
  <div id="list">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
</div>

<script>
const API="https://script.google.com/macros/s/AKfycbwiGfw7FYsWNxmzY_r8Ipc4-fgZLF5Ei4VN74vhI4Ar6c67RDlXBN9EDb1_YdJDZOpgGA/exec";
let PASS="";

function login(){
  PASS=document.getElementById("pass").value;
  fetch(API,{method:"POST",body:JSON.stringify({action:"get",password:PASS})})
  .then(r=>r.json())
  .then(d=>{
    if(d.error){
      document.getElementById("msg").textContent="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
    }else{
      document.getElementById("login").classList.add("hidden");
      document.getElementById("panel").classList.remove("hidden");
      load();
    }
  });
}

function load(){
  fetch(API,{method:"POST",body:JSON.stringify({action:"get",password:PASS})})
  .then(r=>r.json())
  .then(data=>{
    const box=document.getElementById("list");
    box.innerHTML="";
    data.forEach(l=>{
      box.innerHTML+=`
        <div class="lesson">
          <strong>${l.title}</strong><br>
          ğŸ‘ï¸ ${l.views}<br>
          <button class="${l.status=="ON"?"on":"off"}"
          onclick="toggle('${l.id}','${l.status=="ON"?"OFF":"ON"}')">
          ${l.status}</button>
        </div>`;
    });
  });
}

function addLesson(){
  fetch(API,{
    method:"POST",
    body:JSON.stringify({
      action:"add",
      password:PASS,
      title:document.getElementById("title").value,
      url:document.getElementById("url").value
    })
  }).then(load);
}

function toggle(id,status){
  fetch(API,{
    method:"POST",
    body:JSON.stringify({
      action:"toggle",
      password:PASS,
      id:id,
      status:status
    })
  }).then(load);
}
</script>

</body>
</html>
